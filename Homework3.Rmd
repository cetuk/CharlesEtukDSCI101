---
title: "DSCI 101 HW #3"
author: "Charles Etuk"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(Lahman)
library(nycflights13)
```
### Question 1
##### 1a) Name every player in baseball history who has accumulated at least 300 home runs (HR) AND at least 300 stolen bases.
(SB).
```{r}
HRs <- Batting %>% group_by(playerID) %>% summarise(CareerHRs = sum(HR)) %>% filter(CareerHRs >= 300) %>% arrange(-CareerHRs)
SBs <- Batting %>% group_by(playerID) %>% summarise(CareerSBs = sum(SB)) %>% filter(CareerSBs >= 300) %>% arrange(-CareerSBs)
HRs %>% inner_join(SBs, by = c("playerID" = "playerID")) %>% inner_join(People, by = c("playerID" = "playerID")) %>% select(nameFirst, nameLast, CareerHRs, CareerSBs)
```
8 players have accumulated at least 300 stolen bases and 300 home runs, and those players are Barry Bonds, Alex Rodriguez, Willie Mays, Andre Dawson, Carlos Beltran, Bobby Bonds, Reggie Sanders, and Steve Finley.

##### 1b) Similarly, name every pitcher in baseball history who has accumulated at least 300 wins (W) and at least 3,000 strikeouts (SO).
```{r}
Wins <- Pitching %>% group_by(playerID) %>% summarise(CareerWins = sum(W)) %>% filter(CareerWins >= 300) %>% arrange(-CareerWins)
SOs <- Pitching %>% group_by(playerID) %>% summarise(CareerSOs = sum(SO)) %>% filter(CareerSOs >= 3000) %>% arrange(-CareerSOs)
Wins %>% inner_join(SOs, by = c("playerID" = "playerID")) %>% inner_join(People, by = c("playerID" = "playerID")) %>% select(nameFirst, nameLast, CareerWins, CareerSOs)
```
Walter Johnson, Greg Maddux, Roger Clemens, Steve Carlton, Nolan Ryan, Don Sutton, Phil Niekro, Gaylord Perry, Tom Seaver, and Randy Johnson are the 10 players in MLB history to accumulate more than 300 career wins and 3000 strikeouts.

##### 1c)  Identify the name and year of every player who has hit at least 50 home runs in a single season. Which player had the lowest batting average in that season?
```{r}
HRs <- Batting %>% mutate(BA = H/AB) %>% filter(HR >= 50) %>% select(playerID, yearID, HR, BA) 
HRs %>% inner_join(People, by = c("playerID" = "playerID")) %>% select(nameFirst, nameLast, yearID, BA) %>% arrange(BA)
```
Pete Alonso had the lowest batting average in his 50 home run season at roughly 0.26.

### Question 2
##### 2a) What is the oldest plane (specified by the tailnum variable) that flew from New York City airports in 2013?
```{r}
flights %>% inner_join(planes, by = c("tailnum" = "tailnum")) %>% group_by(tailnum) %>% summarize(oldestplane = min(year.y)) %>% arrange(oldestplane) %>% head(1)
```
The oldest plane that flew from a New York City airport in 2013 was the N381AA in 1956. 

##### 2b) How many airplanes that flew from New York City are included in the planes table?
```{r} 
allflights <- flights %>% inner_join(planes, by = c("tailnum" = "tailnum"))
allflights %>% count(tailnum) %>% nrow()
```
3322 airplanes that flew from NYC are included in the planes table.

